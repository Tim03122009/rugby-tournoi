<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrono Arbitre</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header><h1>Chronomètre Terrain</h1></header>
    <div id="appArbitre"></div>

    <script type="module">
        import { db, ref, onValue, update } from './js/database.js';
        
        onValue(ref(db, 'tournoi/listeMatchs'), (snapshot) => {
            const matchs = snapshot.val();
            const container = document.getElementById('appArbitre');
            if (!matchs) return container.innerHTML = "<p>Aucun match prévu.</p>";

            container.innerHTML = "";
            matchs.forEach((m, index) => {
                if (!m.termine) {
                    const card = document.createElement('div');
                    card.className = "card";
                    card.innerHTML = `
                        <h2>Terrain ${m.terrain} - Match ${m.id}</h2>
                        <h1 style="color:var(--primary)">${m.t1} vs ${m.t2}</h1>
                        <p>Arbitre : <b>${m.arbitre}</b> | Durée : <b>${m.duree}</b></p>
                        <button class="btn-main" style="background:var(--success)" onclick="window.finMatch(${index})">MARQUER COMME TERMINÉ</button>
                    `;
                    container.appendChild(card);
                }
            });

            window.finMatch = (idx) => {
                if(confirm("Confirmer la fin du match ?")) {
                    update(ref(db, `tournoi/listeMatchs/${idx}`), { termine: true });
                }
            };
        });
    </script>
</body>
</html>
